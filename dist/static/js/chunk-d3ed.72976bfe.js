(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-d3ed"],{"/gXl":function(e,t,a){"use strict";a.d(t,"d",function(){return r}),a.d(t,"b",function(){return d}),a.d(t,"c",function(){return o}),a.d(t,"e",function(){return s}),a.d(t,"a",function(){return i});var n=a("t3Un"),r=function(e){return Object(n.a)({url:"/dept",method:"post",data:e})},d=function(){return Object(n.a)({url:"/dept",method:"get"})},o=function(){return Object(n.a)({url:"/dept/tree",method:"get"})},s=function(e){return Object(n.a)({url:"/dept",method:"put",data:e})},i=function(e){return Object(n.a)({url:"/dept/"+e,method:"delete"})}},"5lkm":function(e,t,a){"use strict";a.r(t);var n=a("nOKp"),r=a("/gXl"),d=a("7Qib"),o={components:{PopupTreeInput:n.a},data:function(){return{deptForm:{deptId:0,name:"",parentId:0,parentName:"",sort:0},tableTreeData:[],dataRule:{name:[{required:!0,message:"机构名称不能为空",trigger:"blur"}],parentName:[{required:!0,message:"上级机构不能为空",trigger:"change"}]},popupTreeData:[],popupTreeProps:{label:"name",children:"children"},editLoading:!1,deptName:""}},created:function(){this.findTreeData()},methods:{parseTime:d.b,handleNodeClick:function(e){console.log(e),this.deptForm=e,this.$refs.deptForm.clearValidate()},handleFind:function(){this.findTreeData()},handleNumChange:function(e){this.deptForm.sort=e},handleAdd:function(){if(0===this.deptForm.deptId)this.$message({message:"请先选择一个节点哦",type:"warning"});else{var e=this.deptForm.deptId,t=this.deptForm.name;this.deptForm={deptId:0,name:"",parentId:e,parentName:t,sort:0}}},findTreeData:function(){var e=this;this.loading=!0,Object(r.b)().then(function(t){e.tableTreeData=t.data.data,e.popupTreeData=e.getParentMenuTree(t.data.data),e.loading=!1})},getParentMenuTree:function(e){return[{parentId:0,name:"顶级菜单",children:e}]},handleTreeSelectChange:function(e){this.deptForm.parentId=e.deptId,this.deptForm.parentName=e.name},submitEditForm:function(){var e=this;this.$refs.deptForm.validate(function(t){t&&(e.deptForm.deptId?e.$confirm("确认提交吗？","提示",{}).then(function(){e.editLoading=!0,Object(r.e)(e.deptForm).then(function(t){200===t.data.code?e.$message({message:"操作成功",type:"success"}):e.$message({message:t.data.msg,type:"error"}),e.editLoading=!1,e.$refs.deptForm.clearValidate(),e.findTreeData()})}):(console.log(e.deptForm),e.$confirm("确认提交吗？","提示",{}).then(function(){e.editLoading=!0,Object(r.d)(e.deptForm).then(function(t){200===t.data.code?e.$message({message:"操作成功",type:"success"}):e.$message({message:t.data.msg,type:"error"}),e.editLoading=!1,e.$refs.deptForm.clearValidate(),e.findTreeData()})})))})},handleDelete:function(){var e=this,t=this;0===t.deptForm.deptId?this.$message({message:"请先选择一个部门哦",type:"warning"}):this.$confirm("此操作将把部门删除, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(r.a)(e.deptForm.deptId).then(function(a){200===a.data.code?(e.$message({type:"success",message:"操作成功"}),t.findTreeData()):e.$message({message:res.data.msg,type:"error"})})}).catch(function(){e.$message({type:"info",message:"已取消删除"})})}}},s=(a("ZvOc"),a("KHd+")),i=Object(s.a)(o,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"dept"},[a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{xs:24,sm:12}},[a("div",{staticClass:"app-container"},[a("div",{staticClass:"filter-container"},[a("el-button-group",[a("el-button",{attrs:{type:"primary",plain:""},on:{click:e.handleAdd}},[e._v("\n              添加\n            ")]),e._v(" "),a("el-button",{attrs:{type:"primary",plain:""},on:{click:e.handleDelete}},[e._v("\n              删除\n            ")])],1)],1),e._v(" "),a("el-tree",{attrs:{data:e.tableTreeData,props:e.popupTreeProps,"default-expand-all":!0},on:{"node-click":e.handleNodeClick}})],1)]),e._v(" "),a("el-col",{attrs:{xs:24,sm:12}},[a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v(e._s(""===e.deptForm.deptId?"添加":"编辑"))])]),e._v(" "),a("div",[a("el-form",{ref:"deptForm",attrs:{model:e.deptForm,rules:e.dataRule,"label-position":"right","label-width":"100px"}},[a("el-form-item",{attrs:{label:"上级编号",prop:"parentId"}},[a("popup-tree-input",{attrs:{data:e.popupTreeData,props:e.popupTreeProps,prop:null==e.deptForm.parentName?"顶级菜单":e.deptForm.parentName,"node-key":""+e.deptForm.parentId,"current-change-handle":e.handleTreeSelectChange}})],1),e._v(" "),a("el-form-item",{attrs:{label:"部门名称",prop:"name"}},[a("el-input",{model:{value:e.deptForm.name,callback:function(t){e.$set(e.deptForm,"name",t)},expression:"deptForm.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"排序",prop:"sort"}},[a("el-input-number",{attrs:{min:0,max:100},on:{change:e.handleNumChange},model:{value:e.deptForm.sort,callback:function(t){e.$set(e.deptForm,"sort",t)},expression:"deptForm.sort"}})],1)],1)],1)]),e._v(" "),a("el-card",{staticClass:"box-card",staticStyle:{"margin-top":"-2rem"}},[a("el-row",[a("el-col",{staticStyle:{"text-align":"right"},attrs:{span:24}},[a("el-button",{attrs:{type:"primary",plain:"",loading:e.editLoading},on:{click:e.submitEditForm}},[e._v(e._s(""==e.deptForm.deptId?"添加":"编辑")+"\n            ")])],1)],1)],1)],1)],1)],1)},[],!1,null,"4db4f48c",null);i.options.__file="dept.vue";t.default=i.exports},ZvOc:function(e,t,a){"use strict";var n=a("tpd2");a.n(n).a},tpd2:function(e,t,a){}}]);