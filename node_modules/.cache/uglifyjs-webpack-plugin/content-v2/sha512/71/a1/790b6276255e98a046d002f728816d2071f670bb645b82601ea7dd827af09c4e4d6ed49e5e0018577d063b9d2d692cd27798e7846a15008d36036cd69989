{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[\"chunk-6fa7\"],{\"/gXl\":function(e,t,a){\"use strict\";a.d(t,\"d\",function(){return i}),a.d(t,\"b\",function(){return r}),a.d(t,\"c\",function(){return l}),a.d(t,\"e\",function(){return o}),a.d(t,\"a\",function(){return s});var n=a(\"t3Un\"),i=function(e){return Object(n.a)({url:\"/dept\",method:\"post\",data:e})},r=function(){return Object(n.a)({url:\"/dept\",method:\"get\"})},l=function(){return Object(n.a)({url:\"/dept/tree\",method:\"get\"})},o=function(e){return Object(n.a)({url:\"/dept\",method:\"put\",data:e})},s=function(e){return Object(n.a)({url:\"/dept/\"+e,method:\"delete\"})}},\"1Xwi\":function(e,t,a){},\"5lkm\":function(e,t,a){\"use strict\";a.r(t);var n=a(\"nOKp\"),i=a(\"itRl\"),r=a(\"/gXl\"),l=a(\"7Qib\"),o={components:{PopupTreeInput:n.a,treeTable:i.a},data:function(){return{size:\"small\",keyword:\"\",tableData:[],title:\"增加分类\",dialogFormVisible:!1,formLabelWidth:\"120px\",isEditForm:!1,loading:!1,dialogVisible:!1,defaultExpandAll:!0,key:1,columns:[{label:\"机构名称\",key:\"name\",expand:!0},{label:\"上级机构\",key:\"parentName\",width:200,align:\"center\"},{label:\"排序\",key:\"sort\",align:\"center\"},{label:\"创建时间\",key:\"createTime\",align:\"center\"},{label:\"操作\",key:\"operation\"}],dataForm:{deptId:0,name:\"\",parentId:0,parentName:\"\",sort:0},tableTreeData:[],dataRule:{name:[{required:!0,message:\"机构名称不能为空\",trigger:\"blur\"}],parentName:[{required:!0,message:\"上级机构不能为空\",trigger:\"change\"}]},popupTreeData:[],popupTreeProps:{label:\"name\",children:\"children\"},editLoading:!1}},created:function(){this.findTreeData()},methods:{parseTime:l.b,handleFind:function(){this.findTreeData()},handleAdd:function(){this.dialogVisible=!0,this.dataForm={deptId:0,name:\"\",parentId:0,parentName:\"\",sort:0}},handleEdit:function(e){this.isEditForm=!0,this.dialogVisible=!0,this.dataForm.deptId=e.deptId,this.dataForm.name=e.name,this.dataForm.parentId=e.parentId,this.dataForm.sort=e.sort,this.dataForm.parentName=e.parentName},findTreeData:function(){var e=this;this.loading=!0,Object(r.b)().then(function(t){e.tableTreeData=t.data.data,e.popupTreeData=e.getParentMenuTree(t.data.data),e.loading=!1})},getParentMenuTree:function(e){return[{parentId:0,name:\"顶级菜单\",children:e}]},handleTreeSelectChange:function(e){this.dataForm.parentId=e.deptId,this.dataForm.parentName=e.name},iconActiveHandle:function(e){this.dataForm.icon=e},handleDelete:function(e){var t=this,a=this;this.$confirm(\"此操作将把分类删除, 是否继续?\",\"提示\",{confirmButtonText:\"确定\",cancelButtonText:\"取消\",type:\"warning\"}).then(function(){Object(r.a)(e.deptId).then(function(e){200===e.data.code?(t.$message({type:\"success\",message:\"操作成功\"}),a.findTreeData()):t.$message({message:res.data.msg,type:\"error\"})})}).catch(function(){t.$message({type:\"info\",message:\"已取消删除\"})})},submitEditForm:function(){var e=this;this.isEditForm?this.$refs.dataForm.validate(function(t){t&&e.$confirm(\"确认提交吗？\",\"提示\",{}).then(function(){e.editLoading=!0,Object(r.e)(e.dataForm).then(function(t){200===t.data.code?e.$message({message:\"操作成功\",type:\"success\"}):e.$message({message:t.data.msg,type:\"error\"}),e.editLoading=!1,e.$refs.dataForm.resetFields(),e.dialogVisible=!1,e.findTreeData()})})}):this.$refs.dataForm.validate(function(t){t&&e.$confirm(\"确认提交吗？\",\"提示\",{}).then(function(){e.editLoading=!0,Object(r.d)(e.dataForm).then(function(t){200===t.data.code?e.$message({message:\"操作成功\",type:\"success\"}):e.$message({message:t.data.msg,type:\"error\"}),e.editLoading=!1,e.$refs.dataForm.resetFields(),e.dialogVisible=!1,e.findTreeData()})})})},expand:function(){this.$parent.expand=!this.$parent.expand,this.defaultExpandAll=this.$parent.expand}}},s=a(\"KHd+\"),d=Object(s.a)(o,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a(\"div\",{staticClass:\"app-container\"},[a(\"div\",{staticClass:\"filter-container\",staticStyle:{margin:\"10px 0 10px 0\"}},[a(\"el-input\",{staticClass:\"filter-item\",staticStyle:{width:\"200px\"},attrs:{clearable:\"\",placeholder:\"请输入部门名称\"},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:\"keyword\"}}),e._v(\" \"),a(\"el-button\",{staticClass:\"filter-item\",attrs:{size:\"small\",type:\"primary\",icon:\"el-icon-search\"},on:{click:e.handleFind}},[e._v(\"查找\\n    \")]),e._v(\" \"),a(\"el-button\",{staticClass:\"filter-item\",attrs:{size:\"mini\",type:\"primary\",icon:\"el-icon-plus\"},on:{click:e.handleAdd}},[e._v(\"添加部门\")]),e._v(\" \"),a(\"el-button\",{staticClass:\"filter-item\",attrs:{size:\"mini\",type:\"warning\",icon:\"el-icon-more\"},on:{click:e.expand}},[e._v(e._s(e.defaultExpandAll?\"折叠\":\"展开\"))])],1),e._v(\" \"),a(\"tree-table\",{key:e.key,attrs:{\"default-expand-all\":e.defaultExpandAll,data:e.tableTreeData,columns:e.columns,size:\"small\"},scopedSlots:e._u([{key:\"createTime\",fn:function(t){var n=t.scope;return[a(\"span\",[e._v(e._s(e.parseTime(n.row.createTime)))])]}},{key:\"operation\",fn:function(t){var n=t.scope;return[a(\"el-button\",{attrs:{size:\"mini\",icon:\"el-icon-edit\"},on:{click:function(t){e.handleEdit(n.row)}}},[e._v(\"编辑\")]),e._v(\" \"),a(\"el-button\",{attrs:{type:\"danger\",size:\"mini\",icon:\"el-icon-delete\"},on:{click:function(t){e.handleDelete(n.row)}}},[e._v(\"删除\")])]}}])}),e._v(\" \"),a(\"el-dialog\",{attrs:{title:e.dataForm.deptId?\"修改部门\":\"新增部门\",width:\"40%\",visible:e.dialogVisible,\"close-on-click-modal\":!1},on:{\"update:visible\":function(t){e.dialogVisible=t}}},[a(\"el-form\",{ref:\"dataForm\",staticStyle:{\"text-align\":\"left\"},attrs:{model:e.dataForm,rules:e.dataRule,\"label-width\":\"80px\",size:e.size},nativeOn:{keyup:function(t){if(!(\"button\"in t)&&e._k(t.keyCode,\"enter\",13,t.key,\"Enter\"))return null;e.submitForm()}}},[a(\"el-form-item\",{attrs:{label:\"机构名称\",prop:\"name\"}},[a(\"el-input\",{attrs:{placeholder:\"请输入机构名称\"},model:{value:e.dataForm.name,callback:function(t){e.$set(e.dataForm,\"name\",t)},expression:\"dataForm.name\"}})],1),e._v(\" \"),a(\"el-form-item\",{attrs:{label:\"上级机构\",prop:\"parentName\"}},[a(\"popup-tree-input\",{attrs:{data:e.popupTreeData,props:e.popupTreeProps,prop:null==e.dataForm.parentName?\"顶级菜单\":e.dataForm.parentName,\"node-key\":\"\"+e.dataForm.parentId,\"current-change-handle\":e.handleTreeSelectChange}})],1),e._v(\" \"),2!==e.dataForm.type?a(\"el-form-item\",{attrs:{label:\"排序编号\",prop:\"sort\"}},[a(\"el-input-number\",{attrs:{\"controls-position\":\"right\",min:0,label:\"排序编号\"},model:{value:e.dataForm.sort,callback:function(t){e.$set(e.dataForm,\"sort\",t)},expression:\"dataForm.sort\"}})],1):e._e()],1),e._v(\" \"),a(\"span\",{staticClass:\"dialog-footer\",attrs:{slot:\"footer\"},slot:\"footer\"},[a(\"el-button\",{attrs:{size:e.size},on:{click:function(t){e.dialogVisible=!1}}},[e._v(\"取消\")]),e._v(\" \"),a(\"el-button\",{attrs:{size:e.size,type:\"primary\",loading:e.editLoading},on:{click:e.submitEditForm}},[e._v(\"确定\")])],1)],1)],1)},[],!1,null,null,null);d.options.__file=\"dept.vue\";t.default=d.exports},itRl:function(e,t,a){\"use strict\";var n=a(\"4d7F\"),i=a.n(n),r=a(\"Kw5r\");function l(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=t.parent,n=void 0===a?null:a,i=t.preIndex,o=void 0!==i&&i,s=t.level,d=void 0===s?0:s,c=t.expand,u=void 0!==c&&c,p=t.children,h=void 0===p?\"children\":p,m=t.show,f=void 0===m||m,g=t.select,b=void 0!==g&&g;e.forEach(function(e,t){var a=(o?o+\"-\"+t:t)+\"\";r.default.set(e,\"_id\",a),r.default.set(e,\"_level\",d),r.default.set(e,\"_expand\",u),r.default.set(e,\"_parent\",n),r.default.set(e,\"_show\",f),r.default.set(e,\"_select\",b),e[h]&&e[h].length>0&&l(e[h],{parent:e,level:d+1,expand:u,preIndex:a,children:h,status:status,select:b})})}var o={name:\"TreeTable\",props:{data:{type:Array,required:!0,default:function(){return[]}},columns:{type:Array,default:function(){return[]}},defaultExpandAll:{type:Boolean,default:!1},defaultChildren:{type:String,default:\"children\"},indent:{type:Number,default:50}},data:function(){return{guard:1}},computed:{children:function(){return this.defaultChildren},tableData:function(){var e=this.data;return 0===this.data.length?[]:(l(e,{expand:this.defaultExpandAll,children:this.defaultChildren}),function e(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:\"children\",n=[];return t.forEach(function(t,i){if(r.default.set(t,\"_index\",i),n.push(t),t[a]&&t[a].length>0){var l=e(t[a],a);n=n.concat(l)}}),n}(e,this.defaultChildren))}},methods:{addBrother:function(e,t){e._parent?e._parent.children.push(t):this.data.push(t)},addChild:function(e,t){e.children||this.$set(e,\"children\",[]),e.children.push(t)},delete:function(e){var t=e._index,a=e._parent;a?a.children.splice(t,1):this.data.splice(t,1)},getData:function(){return this.tableData},showRow:function(e){var t=e.row,a=t._parent,n=!a||a._expand&&a._show;return t._show=n,n?\"animation:treeTableShow 1s;-webkit-animation:treeTableShow 1s;\":\"display:none;\"},showSperadIcon:function(e){return e[this.children]&&e[this.children].length>0},toggleExpanded:function(e){var t=this.tableData[e],a=!t._expand;t._expand=a},handleCheckAllChange:function(e){this.selcetRecursion(e,e._select,this.defaultChildren),this.isIndeterminate=e._select},selcetRecursion:function(e,t){var a=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:\"children\";t&&(this.$set(e,\"_expand\",!0),this.$set(e,\"_show\",!0));var i=e[n];i&&i.length>0&&i.map(function(e){e._select=t,a.selcetRecursion(e,t,n)})},updateTreeNode:function(e){var t=this;return new i.a(function(a){var n=e._id,i=e._parent,r=n.split(\"-\").slice(-1)[0];i?(i.children.splice(r,1,e),a(t.data)):(t.data.splice(r,1,e),a(t.data))})}}},s=(a(\"x7Y3\"),a(\"KHd+\")),d=Object(s.a)(o,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a(\"el-table\",e._g(e._b({attrs:{data:e.tableData,\"row-style\":e.showRow}},\"el-table\",e.$attrs,!1),e.$listeners),[e._t(\"selection\"),e._v(\" \"),e._t(\"pre-column\"),e._v(\" \"),e._l(e.columns,function(t){return a(\"el-table-column\",{key:t.key,attrs:{label:t.label,width:t.width,align:t.align||\"center\",\"header-align\":t.headerAlign},scopedSlots:e._u([{key:\"default\",fn:function(n){return[e._t(t.key,[t.expand?[a(\"span\",{style:{\"padding-left\":+n.row._level*e.indent+\"px\"}}),e._v(\" \"),a(\"span\",{directives:[{name:\"show\",rawName:\"v-show\",value:e.showSperadIcon(n.row),expression:\"showSperadIcon(scope.row)\"}],staticClass:\"tree-ctrl\",on:{click:function(t){e.toggleExpanded(n.$index)}}},[n.row._expand?a(\"i\",{staticClass:\"el-icon-minus\"}):a(\"i\",{staticClass:\"el-icon-plus\"})])]:e._e(),e._v(\" \"),t.checkbox?[n.row[e.defaultChildren]&&n.row[e.defaultChildren].length>0?a(\"el-checkbox\",{style:{\"padding-left\":+n.row._level*e.indent+\"px\"},attrs:{indeterminate:n.row._select},on:{change:function(t){e.handleCheckAllChange(n.row)}},model:{value:n.row._select,callback:function(t){e.$set(n.row,\"_select\",t)},expression:\"scope.row._select\"}}):a(\"el-checkbox\",{style:{\"padding-left\":+n.row._level*e.indent+\"px\"},on:{change:function(t){e.handleCheckAllChange(n.row)}},model:{value:n.row._select,callback:function(t){e.$set(n.row,\"_select\",t)},expression:\"scope.row._select\"}})]:e._e(),e._v(\"\\n        \"+e._s(n.row[t.key])+\"\\n      \")],{scope:n})]}}])})})],2)},[],!1,null,null,null);d.options.__file=\"index.vue\";t.a=d.exports},x7Y3:function(e,t,a){\"use strict\";var n=a(\"1Xwi\");a.n(n).a}}]);","extractedComments":[]}