{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[\"chunk-5dd6\"],{\"/gXl\":function(e,t,n){\"use strict\";n.d(t,\"d\",function(){return o}),n.d(t,\"b\",function(){return r}),n.d(t,\"c\",function(){return a}),n.d(t,\"e\",function(){return i}),n.d(t,\"a\",function(){return s});var l=n(\"t3Un\"),o=function(e){return Object(l.a)({url:\"/dept\",method:\"post\",data:e})},r=function(){return Object(l.a)({url:\"/dept\",method:\"get\"})},a=function(){return Object(l.a)({url:\"/dept/tree\",method:\"get\"})},i=function(e){return Object(l.a)({url:\"/dept\",method:\"put\",data:e})},s=function(e){return Object(l.a)({url:\"/dept/\"+e,method:\"delete\"})}},Oc90:function(e,t,n){\"use strict\";n(\"Qyje\")},Uz2U:function(e,t,n){\"use strict\";n.r(t);var l=n(\"XVEU\"),o=n(\"Hycs\"),r=n(\"7Qib\"),a=n(\"/gXl\"),i=n(\"cCY5\"),s=n.n(i),d=(n(\"VCwm\"),n(\"Oc90\"),{components:{Treeselect:s.a},data:function(){return{tableData:[],keyword:\"\",title:\"\",dialogFormVisible:!1,formLabelWidth:\"120px\",isEditForm:!1,dateScopes:[{id:1,des:\"全部\"},{id:2,des:\"本级\"},{id:3,des:\"本级以及子级\"},{id:4,des:\"自定义\"}],deptData:[],deptTreeProps:{label:\"name\",children:\"children\"},form:{roleId:0,roleName:\"\",roleCode:\"\",roleDesc:\"\",roleMenus:[],dsType:0,deptName:\"\",deptId:1},menuData:[],defaultProps:{children:\"children\",label:\"name\"},selectRole:{},checkAll:!1,menuIds:[],dataRule:{roleName:[{required:!0,message:\"角色名称不能为空\",trigger:\"blur\"}],roleDesc:[{required:!0,message:\"角色介绍不能为空\",trigger:\"blur\"}],roleCode:[{required:!0,message:\"角色标识不能为空\",trigger:\"blur\"}]},loading:!1,deptIds:[]}},created:function(){this.findTreeData(),this.roleList()},methods:{parseTime:r.b,roleList:function(){var e=this;this.loading=!0;var t=new URLSearchParams;t.append(\"roleName\",this.keyword),Object(l.d)(t).then(function(t){e.tableData=t.data.data,e.loading=!1})},findTreeData:function(){var e=this;this.menuLoading=!0,Object(o.c)().then(function(t){e.menuData=t.data.data,e.menuLoading=!1})},handleMenuCheckChange:function(e,t){var n=this;if(t){var l=e.parentId;this.$refs.menuTree.setChecked(l,!0,!1)}else null!=e.children&&e.children.forEach(function(e){n.$refs.menuTree.setChecked(e.id,!1,!1)})},handleCheckAll:function(){if(this.checkAll){var e=[];this.checkAllMenu(this.menuData,e),this.$refs.menuTree.setCheckedNodes(e)}else this.$refs.menuTree.setCheckedNodes([])},checkAllMenu:function(e,t){var n=this;e.forEach(function(e){t.push(e),e.children&&n.checkAllMenu(e.children,t)})},handleFind:function(){this.roleList()},handleAdd:function(){this.dialogFormVisible=!0,this.title=\"增加角色\",this.form={roleId:0,roleName:\"\",roleCode:\"\",roleDesc:\"\",roleMenus:[],roleDepts:[],dsType:\"\",deptName:\"\",deptId:1},this.isEditForm=!1},handleEdit:function(e){this.dialogFormVisible=!0,this.isEditForm=!0,this.title=\"编辑角色\",this.form=e,this.handleRoleSelectChange(e.roleId),this.deptIds=[],4===this.form.dsType&&this.findDeptTree();for(var t=0;t<this.form.roleDepts.length;t++)this.deptIds[t]=this.form.roleDepts[t]},handleRoleSelectChange:function(e){var t=this;this.selectRole.id=e,Object(l.c)(e).then(function(e){t.$refs.menuTree.setCheckedNodes(e.data.data)})},handleDelete:function(e){var t=this,n=this;this.$confirm(\"此操作将把角色删除, 是否继续?\",\"提示\",{confirmButtonText:\"确定\",cancelButtonText:\"取消\",type:\"warning\"}).then(function(){Object(l.b)(e.roleId).then(function(e){200===e.data.code?(t.$message({type:\"success\",message:\"操作成功\"}),n.roleList()):t.$message({type:\"error\",message:e.data.msg})})}).catch(function(){t.$message({type:\"info\",message:\"已取消删除\"})})},submitForm:function(){var e=this;if(4!==this.form.dsType||0!==this.deptIds.length){var t=[];if(4===this.form.dsType){for(var n=0;n<this.deptIds.length;n++)t.push(this.deptIds[n]);this.form.roleDepts=t}for(var o=this.selectRole.id>0?this.selectRole.id:0,r=this.$refs.menuTree.getCheckedNodes(!1,!0),a=[],i=0,s=r.length;i<s;i++){var d={roleId:o,menuId:r[i].menuId};a.push(d)}this.form.roleMenus=a,this.$refs.form.validate(function(t){t&&(e.isEditForm?Object(l.e)(e.form).then(function(t){200===t.data.code?(e.$message({type:\"success\",message:\"操作成功\"}),e.dialogFormVisible=!1,e.roleList()):e.$message({type:\"error\",message:t.data})}):Object(l.a)(e.form).then(function(t){200===t.data.code?(e.$message({type:\"success\",message:\"操作成功\"}),e.dialogFormVisible=!1,e.roleList()):e.$message({type:\"error\",message:t.data.msg})}))})}else this.$message({message:\"自定义数据权限不能为空\",type:\"warning\"})},findDeptTree:function(){var e=this;Object(a.c)().then(function(t){e.deptData=t.data.data})},changeScope:function(){this.deptIds=[],4===this.form.dataScope&&this.findDeptTree()}}}),c=n(\"KHd+\"),u=Object(c.a)(d,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n(\"div\",{staticClass:\"app-container\"},[n(\"div\",{staticClass:\"filter-container\",staticStyle:{margin:\"10px 0 10px 0\"}},[n(\"el-input\",{staticClass:\"filter-item\",staticStyle:{width:\"200px\"},attrs:{clearable:\"\",size:\"small\",placeholder:\"请输入角色名称\"},nativeOn:{keyup:function(t){return\"button\"in t||!e._k(t.keyCode,\"enter\",13,t.key,\"Enter\")?e.handleFind(t):null}},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:\"keyword\"}}),e._v(\" \"),n(\"el-button\",{staticClass:\"filter-item\",attrs:{size:\"mini\",type:\"primary\",icon:\"el-icon-search\"},on:{click:e.handleFind}},[e._v(\"查找\\n    \")]),e._v(\" \"),n(\"el-button\",{staticClass:\"filter-item\",attrs:{size:\"mini\",type:\"primary\",icon:\"el-icon-plus\"},on:{click:e.handleAdd}},[e._v(\"添加角色\")])],1),e._v(\" \"),n(\"el-table\",{directives:[{name:\"loading\",rawName:\"v-loading\",value:e.loading,expression:\"loading\"}],staticStyle:{width:\"100%\"},attrs:{data:e.tableData,size:\"mini\"}},[n(\"el-table-column\",{attrs:{type:\"selection\"}}),e._v(\" \"),n(\"el-table-column\",{attrs:{label:\"序号\",width:\"60\",align:\"center\"},scopedSlots:e._u([{key:\"default\",fn:function(t){return[n(\"span\",[e._v(e._s(t.$index+1))])]}}])}),e._v(\" \"),n(\"el-table-column\",{attrs:{label:\"角色名称\",width:\"200\",align:\"center\"},scopedSlots:e._u([{key:\"default\",fn:function(t){return[n(\"span\",[e._v(e._s(t.row.roleName))])]}}])}),e._v(\" \"),n(\"el-table-column\",{attrs:{label:\"角色标识\",width:\"200\",align:\"center\"},scopedSlots:e._u([{key:\"default\",fn:function(t){return[n(\"span\",[e._v(e._s(t.row.roleCode))])]}}])}),e._v(\" \"),n(\"el-table-column\",{attrs:{label:\"角色介绍\",width:\"200\",align:\"center\"},scopedSlots:e._u([{key:\"default\",fn:function(t){return[n(\"span\",[e._v(e._s(t.row.roleDesc))])]}}])}),e._v(\" \"),n(\"el-table-column\",{attrs:{label:\"创建时间\",width:\"160\",align:\"center\",prop:\"createTime\"},scopedSlots:e._u([{key:\"default\",fn:function(t){return[n(\"span\",[e._v(e._s(e.parseTime(t.row.createTime)))])]}}])}),e._v(\" \"),n(\"el-table-column\",{attrs:{label:\"操作\",fixed:\"right\",\"min-width\":\"150\",align:\"center\"},scopedSlots:e._u([{key:\"default\",fn:function(t){return[n(\"el-button\",{attrs:{size:\"mini\",icon:\"el-icon-edit\"},on:{click:function(n){e.handleEdit(t.row)}}},[e._v(\"编辑\")]),e._v(\" \"),n(\"el-button\",{attrs:{type:\"danger\",size:\"mini\",icon:\"el-icon-delete\"},on:{click:function(n){e.handleDelete(t.row)}}},[e._v(\"删除\")])]}}])})],1),e._v(\" \"),n(\"el-dialog\",{attrs:{title:e.title,visible:e.dialogFormVisible},on:{\"update:visible\":function(t){e.dialogFormVisible=t}}},[n(\"el-form\",{ref:\"form\",attrs:{model:e.form,rules:e.dataRule}},[n(\"el-form-item\",{attrs:{label:\"角色名称\",\"label-width\":e.formLabelWidth,prop:\"roleName\"}},[n(\"el-input\",{attrs:{\"auto-complete\":\"off\",placeholder:\"请输入角色名称\"},model:{value:e.form.roleName,callback:function(t){e.$set(e.form,\"roleName\",t)},expression:\"form.roleName\"}})],1),e._v(\" \"),n(\"el-form-item\",{attrs:{label:\"角色标识\",\"label-width\":e.formLabelWidth,prop:\"roleCode\"}},[n(\"el-input\",{attrs:{\"auto-complete\":\"off\",placeholder:\"请输入角色标识\"},model:{value:e.form.roleCode,callback:function(t){e.$set(e.form,\"roleCode\",t)},expression:\"form.roleCode\"}})],1),e._v(\" \"),n(\"el-form-item\",{attrs:{label:\"角色介绍\",\"label-width\":e.formLabelWidth,prop:\"roleDesc\"}},[n(\"el-input\",{attrs:{\"auto-complete\":\"off\",placeholder:\"请输入角色介绍\"},model:{value:e.form.roleDesc,callback:function(t){e.$set(e.form,\"roleDesc\",t)},expression:\"form.roleDesc\"}})],1),e._v(\" \"),n(\"el-form-item\",{attrs:{label:\"数据范围\",\"label-width\":e.formLabelWidth}},[n(\"el-select\",{staticStyle:{width:\"100%\"},attrs:{placeholder:\"请选择数据范围\"},on:{change:e.changeScope},model:{value:e.form.dsType,callback:function(t){e.$set(e.form,\"dsType\",t)},expression:\"form.dsType\"}},e._l(e.dateScopes,function(e){return n(\"el-option\",{key:e.id,attrs:{label:e.des,value:e.id}})}))],1),e._v(\" \"),4===e.form.dsType?n(\"el-form-item\",{attrs:{label:\"数据权限\",\"label-width\":e.formLabelWidth}},[n(\"treeselect\",{attrs:{options:e.deptData,multiple:\"\",placeholder:\"请选择\"},model:{value:e.deptIds,callback:function(t){e.deptIds=t},expression:\"deptIds\"}})],1):e._e(),e._v(\" \"),n(\"el-form-item\",{attrs:{label:\"访问菜单\",\"label-width\":e.formLabelWidth}},[n(\"el-tree\",{directives:[{name:\"loading\",rawName:\"v-loading\",value:e.menuLoading,expression:\"menuLoading\"}],ref:\"menuTree\",attrs:{data:e.menuData,size:\"mini\",\"show-checkbox\":\"\",\"node-key\":\"menuId\",props:e.defaultProps,\"element-loading-text\":\"拼命加载中\",\"check-strictly\":!0},on:{\"check-change\":e.handleMenuCheckChange}}),e._v(\" \"),n(\"div\",{staticStyle:{\"padding-left\":\"24px\",\"padding-top\":\"12px\"}},[n(\"el-checkbox\",{attrs:{disabled:!1},on:{change:e.handleCheckAll},model:{value:e.checkAll,callback:function(t){e.checkAll=t},expression:\"checkAll\"}},[n(\"b\",[e._v(\"全选\")])])],1)],1)],1),e._v(\" \"),n(\"div\",{staticClass:\"dialog-footer\",attrs:{slot:\"footer\"},slot:\"footer\"},[n(\"el-button\",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v(\"取 消\")]),e._v(\" \"),n(\"el-button\",{attrs:{type:\"primary\"},on:{click:e.submitForm}},[e._v(\"确 定\")])],1)],1)],1)},[],!1,null,null,null);u.options.__file=\"role.vue\";t.default=u.exports},XVEU:function(e,t,n){\"use strict\";n.d(t,\"d\",function(){return o}),n.d(t,\"b\",function(){return r}),n.d(t,\"a\",function(){return a}),n.d(t,\"e\",function(){return i}),n.d(t,\"c\",function(){return s});var l=n(\"t3Un\");function o(e){return Object(l.a)({url:\"/role\",method:\"get\",params:e})}function r(e){return Object(l.a)({url:\"/role/\"+e,method:\"delete\"})}function a(e){return Object(l.a)({url:\"/role\",method:\"post\",data:e})}function i(e){return Object(l.a)({url:\"role\",method:\"put\",data:e})}function s(e){return Object(l.a)({url:\"/role/findRoleMenus/\"+e,method:\"get\"})}}}]);","extractedComments":[]}